#!/usr/bin/env ruby
require 'optparse'
require_relative 'config/zeitwerk'
require_relative 'config/bundler'

options = {}
OptionParser.new do |opts|
  opts.banner = 'Usage: ansible.rb [options]'

  opts.on('-c', '--command COMMAND', 'Specify command') do |cmd|
    options[:command] = cmd
  end

  opts.on('-e', '--env ENV', 'Specify env') do |env|
    options[:env] = env
  end

  opts.on('-m', '--module MODULE', 'Specify module') do |mod|
    options[:module] = mod
  end

  opts.on('--tags TAGS', 'Specify tags') do |tags|
    options[:tags] = tags
  end

  opts.on('--token TOKEN', 'Specify TOKEN') do |token|
    options[:token] = token
  end

  opts.on('-i', '--inventory INVENTORY', 'Specify inventory') do |inventory|
    options[:inventory] = inventory
  end

  opts.on('-w', '--args WEB_IP', 'Specify web ip') do |web_ip|
    options[:web_ip] = web_ip
  end
end.parse!

options[:web_ip] ||= ENV['WEB_IP']
options[:token] ||= ENV['DO_TOKEN']

Runner.run(options)
